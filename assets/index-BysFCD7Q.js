(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const m of n.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&i(m)}).observe(document,{childList:!0,subtree:!0});function s(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(e){if(e.ep)return;e.ep=!0;const n=s(e);fetch(e.href,n)}})();const y=20,a=14,S=30,f={LEFT:"ArrowLeft",RIGHT:"ArrowRight",DOWN:"ArrowDown",UP:" ",ROTATE:"z",REVERSE_ROTATE:"x",PUSH:"ArrowUp",PAUSE:"Escape",ENTER:"Enter",CONTROL:"Control"},g=[{name:"square",position:{x:a/2-1,y:0},shape:[[1,1],[1,1]],color:"red"},{name:"line",position:{x:a/2-2,y:0},shape:[[1,1,1,1]],color:"royalblue"},{name:"arrow",position:{x:a/2-1,y:0},shape:[[0,1,0],[1,1,1]],color:"orange"},{name:"snake",position:{x:a/2-1,y:0},shape:[[1,1,0],[0,1,1]],color:"green"},{name:"reverseSnake",position:{x:a/2-1,y:0},shape:[[0,1,1],[1,1,0]],color:"hotpink"},{name:"l",position:{x:a/2-1,y:0},shape:[[1,0],[1,0],[1,1]],color:"purple"},{name:"reverseL",position:{x:a/2-1,y:0},shape:[[0,1],[0,1],[1,1]],color:"brown"}],c=new Audio("tetris.mp3");c.volume=.5;const h=document.querySelector("canvas"),l=h.getContext("2d"),L=document.querySelector("#puntuation"),d=document.querySelector("section");let w=0,O=1e3;h.width=y*a;h.height=y*S;l.scale(y,y);const p={shape:P(a,S),position:{x:0,y:0},color:"yellow"};function P(o,t){return Array(t).fill().map(()=>Array(o).fill(0))}let r,E=0,R=0;function A(o=0){const t=o-R;R=o;const s=Math.max(1+Math.floor(o/78010)*.05,0);s!==c.playbackRate&&(c.playbackRate=s),O=Math.max(1e3-Math.floor(o/30)*.05,0),E+=t,E>O&&(v("ArrowDown"),E=0),N(),window.requestAnimationFrame(A)}function N(){l.fillStyle="#000",l==null||l.fillRect(0,0,h.width,h.height),x(p),x(r),L.innerText=w}function x(o){o.shape.forEach((t,s)=>{t.forEach((i,e)=>{i===1&&(l.fillStyle=o.color,l.fillRect(e+o.position.x,s+o.position.y,1,1))})})}document.addEventListener("keydown",o=>{v(o.key)});function v(o){let t=[],s=null;switch(o){case f.LEFT:r.position.x--,u()&&r.position.x++;break;case f.RIGHT:r.position.x++,u()&&r.position.x--;break;case f.DOWN:r.position.y++,u()&&(r.position.y--,b(),k());break;case f.UP:case f.ROTATE:for(let i=0;i<r.shape[0].length;i++){const e=[];for(let n=r.shape.length-1;n>=0;n--)e.push(r.shape[n][i]);t.push(e)}s=r.shape,r.shape=t,u()&&(r.shape=s);break}}function u(){return r.shape.find((o,t)=>o.find((s,i)=>{var e;return s!==0&&((e=p.shape[t+r.position.y])==null?void 0:e[i+r.position.x])!==0}))}function b(){r.shape.forEach((o,t)=>{o.forEach((s,i)=>{s===1&&(p.shape[t+r.position.y][i+r.position.x]=1)})}),w+=5,T(),u()&&M()}function M(){c.pause(),c.playbackRate=.5,c.currentTime=0,window.alert("Game Over!!! Sorry!"),p.shape.forEach(o=>o.fill(0)),T()}function T(){r=JSON.parse(JSON.stringify({...g[Math.floor(Math.random()*g.length)]}))}function k(){const o=[];let t=0;p.shape.forEach((i,e)=>{i.every(n=>n===1)&&(o.push(e),t+=20)});const s=Math.max(o.length,1)-1;t+=s*25,o.forEach(i=>{p.shape.splice(i,1);const e=Array(a).fill(0);p.shape.unshift(e)}),w+=t}d==null||d.addEventListener("click",()=>{T(),A(),c.loop=!0,c.play(),d.remove()});
