(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const f of o.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&n(f)}).observe(document,{childList:!0,subtree:!0});function i(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(e){if(e.ep)return;e.ep=!0;const o=i(e);fetch(e.href,o)}})();const u=20,r=14,R=30,l={LEFT:"ArrowLeft",RIGHT:"ArrowRight",DOWN:"ArrowDown",UP:"ArrowUp",ROTATE:" ",REVERSE_ROTATE:"x",PUSH:"ArrowUp",PAUSE:"Escape",ENTER:"Enter",CONTROL:"Control"},Y="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAIAAADZrBkAAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACMSURBVDhPrY7bEcMgDATTMDVQnEugIHL2XmzGluXHZD80IPaQPv0Vjk0LtVbqeNiBP8dktNbcTuEvx2jdZ5vGXYcEHBHEtK3gMLsDOMIx334xpCOWzqYtTgCOCKYlWHoRK6WoBrF/LskTjriI0VmfVE+XTJAQx9RNsDTG+OwSNMdIhjBknIbv2DN6/wJh1aJTXFO5uwAAAABJRU5ErkJggg==",v=[{name:"square",position:{x:r/2-1,y:0},shape:[[1,1],[1,1]],color:"#F88599",rgb:[248,133,153],image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAxElEQVQ4T2NkYGBgeJXf8h9EH/n4ksGGXxxMgwAyGyyABoIWTGZkBGnmExdj2HbrMjY1OMW81HTBehjXJeSCbScXgF0AczLIVGIAsmsxDGAXEQSb8fPNewYQG0SjAxQDkL0AcgEuTciGEHQBNltxGoDuApLDgFwDrnx8w6DDL4IajWSFASku+PTyFQN6okNJSNjSAUwTiAYBmAE4vUBsIGI1ACRIDAAFHgyAvQDLGMRohqmBZyaQAKEMBXMuzIUwF4CyMwBUFZC9raUyoQAAAABJRU5ErkJggg=="},{name:"line",position:{x:r/2-2,y:0},shape:[[1,1,1,1]],rgb:[156,175,251],color:"#9CAFFB",image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAxElEQVQ4T2NkYGBg6Jz34T+Ifv3kGIOojBWYBgFkNlgADfTUeTEygjQLC3Iz3Li8G5sanGIauq5gPYwlTdvAtpMLwC6AORlkKjEA2bUYBvDxsYDN+PTpDwOIDaLRAYoByF4AuQCXJmRDCLoAm604DUB3AclhQK4Bb19cYRCW0EGNRrLCgBQXvH3/lQE90aEkJGzpAKYJRIMAzACcXiA2ELEaABIkBoACDwbAXoBlDGI0w9TAMxNIgFCGgjkX5kKYC0DZGQAfwJNr7nKi7AAAAABJRU5ErkJggg=="},{name:"arrow",position:{x:r/2-1,y:0},shape:[[0,1,0],[1,1,1]],color:"#FFA77B",rgb:[255,167,123],image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAxElEQVQ4T2NkYGBg+D8l5T+I3vf0G4OTNBeYBgFkNlgADTi3L2NkBGsWFmfYd+k+NjU4xZz0FMF6GPdWRoFtJxeAXQB3sp4iUeYguxbTAH5hiCEf3zIwgNggGg2gGIDsBZC/cGlCNoOwC7DYitMADBcQEQr4vUCkARdefmUwEOdGjUaywoAkL7x9yYCe6FASEtgF6ACqiQFEgwA01eL2AiVhADKVGAAKPBgAewGWMYjRDFMDz0wgAUIZCuZfmAthLgBlZwBvBonjT09XegAAAABJRU5ErkJggg=="},{name:"z",position:{x:r/2-1,y:0},shape:[[1,1,0],[0,1,1]],color:"#9CE0C7",rgb:[156,224,199],image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAxElEQVQ4T2NkYGBg6Ly04z+IfnXhJoOYgTqYBgFkNlgADfTG5TMygjQL8/EzXD90CpsanGKadmZgPYzFiyaCbScXgF0AczLIVGIAsmsxDODj4gGb8enbFwYQG0SjAxQDkL0AcgEuTciGEHQBNltxGoDuApLDgFwD3tx+yCCiKo8ajWSFASkuePvpIwN6okNJSNjSAUwTiAYBmAE4vUBsIGI1ACRIDAAFHgyAvQDLGMRohqmBZyaQAKEMBXMuzIUwF4CyMwBvl5MXVeEacQAAAABJRU5ErkJggg=="},{name:"s",position:{x:r/2-1,y:0},shape:[[0,1,1],[1,1,0]],color:"#87D3D5",rgb:[135,211,213],image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAxElEQVQ4T2NkYGBgKD1y/D+Ifn7sCIOklQ2YBgFkNlgADSwpK2VkBGkW4udjuLp9GzY1OMW0Pb3AehhjurrBtpMLwC6AORlkKjEA2bUYBvBzcYPN+PjtKwOIDaLRAYoByF4AuQCXJmRDCLoAm604DUB3AclhQK4Br69fYxDV1EKNRrLCgBQXvPv4iQE90aEkJGzpAKYJRIMAzACcXiA2ELEaABIkBoACDwbAXoBlDGI0w9TAMxNIgFCGgjkX5kKYC0DZGQBReJAxJHOTqwAAAABJRU5ErkJggg=="},{name:"l",position:{x:r/2-1,y:0},shape:[[1,0],[1,0],[1,1]],color:"#CB88FC",rgb:[203,136,252],image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAxElEQVQ4T2NkYGBg2Fvy6T+IvvnlGIM6jxWYBgFkNlgADWTN8GBkBGnmE+FiOP1gDzY1OMVMFVzAehinZewA204uALsA5mSQqcQAZNdiGMAtwAw24+uHvwwgNohGBygGIHsB5AJcmpANIegCbLbiNADdBSSHAbkGPPh0hUGBTwc1GskKA1Jc8OnNNwb0RIeSkLClA5gmEA0CMANweoHYQMRqAEiQGAAKPBgAewGWMYjRDFMDz0wgAUIZCuZcmAthLgBlZwBQ3ZP3OaGtaAAAAABJRU5ErkJggg=="},{name:"j",position:{x:r/2-1,y:0},shape:[[0,1],[0,1],[1,1]],color:"#FFE5A0",rgb:[255,229,160],image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAw0lEQVQ4T2NkYGBg+Hln0n8QfeLSGwYLPREwDQLIbLAAGrAPamJkBGlm4+RjOHTyHjY1OMXszJXAehgPrqsD204uALsA5mSQqcQAZNdiGsDOAzHj5xcGBhAbRKMBFAOQvQB2AQ5NyGYQdgEWW3EagOECIgIBvxeINODK7bcMOqrCqNFIVhiQ4oVf3z8xoCc6lISELR3ANIFoEIAZgNsLlIQByFRiACjwYADsBVjGIEYzTA08M4EECGUomH9hLoS5AJSdASaukfnTt+kFAAAAAElFTkSuQmCC"}],k=require("bootstrap/js/dist/modal"),s=new Audio("tetris.mp3");s.volume=.5;const E=document.querySelector("canvas"),B=E.getContext("2d"),S=document.querySelector("#puntuation"),m=document.querySelector("section"),G=document.getElementById("gameOverModal");let h=0,D=1e3,p,d=!0,y,O,w=0,a;E.width=u*r;E.height=u*R;B.scale(u,u);const g={shape:x(r,R),position:{x:0,y:0},color:"gray"};function x(A,t){return Array(t).fill().map(()=>Array(A).fill({value:0}))}const C=v.map(A=>({...A,shape:A.shape.map(t=>t.map(i=>({value:i,color:A.color,rgb:A.rgb,image:A.image})))}));function M(){const A=Date.now();if(d)return;const t=Math.max(A-y,0),i=A-O;y=A;const n=1+Math.floor(i/(s.duration/4*1e3))*.01;s.playbackRate!==n&&(s.playbackRate=n),D=Math.max(1e3-Math.floor(i/1e3)*2,100),w+=t,w>D&&(I("ArrowDown"),w=0),U(),window.cancelAnimationFrame(p),p=window.requestAnimationFrame(M)}function U(){B.fillStyle="#000",B.fillRect(0,0,E.width,E.height),Q(g),Q(a),S.innerText=h}function Q(A){A.shape.forEach((t,i)=>{t.forEach((n,e)=>{if(n.value===1){let o=new Image;o.crossOrigin="anonymous",o.src=n.image||A.image||Y,B.drawImage(o,e+A.position.x,i+A.position.y,1,1)}})})}function I(A){let t=[],i=null;switch(A){case l.LEFT:a.position.x--,c()&&a.position.x++;break;case l.RIGHT:a.position.x++,c()&&a.position.x--;break;case l.DOWN:a.position.y++,c()&&(a.position.y--,N(),T());break;case l.UP:a.position.y++,c()?(a.position.y--,N(),T()):I(A);break;case l.ROTATE:for(let n=0;n<a.shape[0].length;n++){const e=[];for(let o=a.shape.length-1;o>=0;o--)e.push(a.shape[o][n]);t.push(e)}i=a.shape,a.shape=t,c()&&(a.shape=i);break}}function c(){return a.shape.find((A,t)=>A.find((i,n)=>{var e,o;return i.value!==0&&((o=(e=g.shape[t+a.position.y])==null?void 0:e[n+a.position.x])==null?void 0:o.value)!==0}))}function N(){a.shape.forEach((A,t)=>{A.forEach((i,n)=>{i.value===1&&(g.shape[t+a.position.y][n+a.position.x]=i)})}),h+=5,F(),c()&&!d&&b()}function b(){d=!0,window.cancelAnimationFrame(p),p=void 0,s.pause(),new k(document.getElementById("gameOverModal")).show(G)}function F(){a=JSON.parse(JSON.stringify({...C[Math.floor(Math.random()*C.length)]}))}function T(){const A=[];let t=0;g.shape.forEach((n,e)=>{n.every(o=>o.value===1)&&(A.push(e),t+=20)});const i=Math.max(A.length,1)-1;t+=i*25,A.forEach(n=>{g.shape.splice(n,1);const e=Array(r).fill({value:0});g.shape.unshift(e)}),h+=t}function L(){h=0,d=!1,F(),s.playbackRate=1,s.currentTime=0,s.loop=!0,s.play(),y=O=Date.now(),M()}document.addEventListener("keydown",A=>{I(A.key)});G.addEventListener("hidden.bs.modal",A=>{g.shape.forEach(i=>i.fill({value:0})),L(),new k(document.getElementById("gameOverModal")).hide(G)});m==null||m.addEventListener("click",()=>{L(),m.remove()});
